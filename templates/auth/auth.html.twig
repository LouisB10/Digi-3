{% extends 'base.html.twig' %}

{% block title %}Digi-3 - Page d'authentification{% endblock %}

{% block body %}
<main id="main-content" role="main">
  <div class="auth-container">
    <!-- Section de connexion -->
    <div class="auth-section flex" id="loginSection" style="display: none" aria-labelledby="login-heading">
      <form id="login_form" method="POST" action="{{ path('app_auth') }}" aria-labelledby="login-form-heading">
        <h2 id="login-form-heading" class="sr-only">Formulaire de connexion</h2>
        <input
          type="hidden"
          name="_csrf_token"
          value="{{ csrf_token('authenticate') }}"
        />
        <input type="hidden" name="action" value="login" />

        <div class="form-group">
          <label for="login_email">Email</label>
          <input type="email" id="login_email" name="email" required aria-required="true" autocomplete="email" />
        </div>

        <div class="form-group">
          <label for="login_password">Mot de passe</label>
          <div class="password-container">
            <input type="password" id="login_password" name="password" required aria-required="true" autocomplete="current-password" />
            <button type="button" class="toggle-password" aria-label="Afficher ou masquer le mot de passe" onclick="togglePasswordVisibility('login_password')">
              <img src="{{ asset('build/images/icons/eye.png') }}" alt="" aria-hidden="true" style="width: 15px; height: 15px;">
            </button>
          </div>
        </div>

        <div class="form-group remember-me">
          <div class="checkbox-container">
            <input type="checkbox" id="remember_me" name="remember_me" />
            <label for="remember_me">Se souvenir de moi</label>
          </div>
          <a href="#" id="forgotPasswordLink" class="forgot-password-link">Mot de passe oublié ?</a>
        </div>

        {% if error %}
        <div class="error" role="alert">{{ error }}</div>
        {% endif %}

        <button type="submit" class="auth-submit">Se connecter</button>
      </form>
      <div class="auth-decorate flex-col" aria-labelledby="login-heading">
        <h3 id="login-heading">Bonjour mon ami !</h3>
        <p>
          Entrez vos informations personnelles et commencez l'aventure avec nous
        </p>
        <a href="#" id="switchToRegister" role="button">S'inscrire</a>
      </div>
    </div>
    <!-- Section d'inscription -->
    <div class="auth-section flex" id="registerSection" aria-labelledby="register-heading">
      <div class="auth-decorate flex-col" aria-labelledby="register-heading">
        <h3 id="register-heading">Content de te revoir !</h3>
        <p>
          Pour rester dans l'aventure avec nous, connectez-vous avec vos
          informations personnelles.
        </p>
        <a href="#" id="switchToLogin" role="button">Se connecter</a>
      </div>
      <form id="register_form" method="POST" action="{{ path('app_register') }}" aria-labelledby="register-form-heading">
        <h2 id="register-form-heading" class="sr-only">Formulaire d'inscription</h2>
        <input
          type="hidden"
          name="csrf_token"
          value="{{ csrf_token('authenticate') }}"
        />
        <input type="hidden" name="action" value="register" />

        <div class="form-group">
          <label for="first_name">Prénom :</label>
          <input type="text" id="first_name" name="first_name" required aria-required="true" autocomplete="given-name" />
        </div>

        <div class="form-group">
          <label for="last_name">Nom :</label>
          <input type="text" id="last_name" name="last_name" required aria-required="true" autocomplete="family-name" />
        </div>

        <div class="form-group">
          <label for="register_email">Email</label>
          <input type="email" id="register_email" name="email" required aria-required="true" autocomplete="email" />
        </div>

        <div class="form-group">
          <label for="register_password">Mot de passe</label>
          <div class="password-container">
            <input type="password" id="register_password" name="password" required aria-required="true" autocomplete="new-password" />
            <button type="button" class="toggle-password" aria-label="Afficher ou masquer le mot de passe" onclick="togglePasswordVisibility('register_password')">
              <img src="{{ asset('build/images/icons/eye.png') }}" alt="" aria-hidden="true" style="width: 15px; height: 15px;">
            </button>
          </div>
        </div>

        {% if error %}
        <div class="error" role="alert">{{ error }}</div>
        {% endif %}

        <button type="submit" class="auth-submit">S'inscrire</button>
      </form>
    </div>
  </div>
  <!-- Modale de réinitialisation -->
  <div id="resetPasswordModal" class="modal" style="display: none;" role="dialog" aria-labelledby="reset-password-heading" aria-modal="true" hidden>
    <div class="modal-content">
      <button type="button" class="close" aria-label="Fermer la boîte de dialogue">&times;</button>
      <h2 id="reset-password-heading">Réinitialisation du mot de passe</h2>
      <form id="resetPasswordForm" aria-labelledby="reset-password-heading">
        <div class="form-group">
          <label for="reset_email">Email</label>
          <input type="email" id="reset_email" name="email" required aria-required="true" autocomplete="email">
        </div>
        <button type="submit" class="auth-submit">Envoyer le lien</button>
      </form>
    </div>
  </div>
</main>

<style>
  /* Style pour les lecteurs d'écran uniquement */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
  
  .form-group {
    margin-bottom: 1rem;
  }
  
  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
  }
  
  .remember-me {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .checkbox-container {
    display: flex;
    align-items: center;
  }
  
  .checkbox-container input[type="checkbox"] {
    margin-right: 0.5rem;
  }
  
  .checkbox-container label {
    margin-bottom: 0;
  }
</style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
{% endblock %}
