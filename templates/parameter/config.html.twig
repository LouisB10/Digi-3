{% extends 'base.html.twig' %} 
{% block title %}Digi-3 - Configuration de l'application{% endblock %}
{% block body %}
{% include 'includes/header.html.twig' with {'user': user} %}
<section class="parameter_landing flex">
  {% include 'parameter/_menu.html.twig' %}
  <div class="parameter_content config">
      <h3>Configuration de l'application</h3>
      
      <div class="parameter-categories">
          <div class="category-tabs flex">
              <button class="tab active" data-category="general">Paramètres Généraux</button>
              <button class="tab" data-category="security">Sécurité</button>
              <button class="tab" data-category="performance">Performance</button>
              <button class="tab" data-category="notifications">Notifications</button>
          </div>

          <div class="category-content">
              <div id="general-params" class="category-panel active">
                  <h4>Paramètres Généraux</h4>
                  <table>
                      <thead>
                          <tr>
                              <th>Clé</th>
                              <th>Valeur</th>
                              <th>Date Début</th>
                              <th>Date Fin</th>
                              <th>Actions</th>
                          </tr>
                      </thead>
                      <tbody id="general-parameter-table">
                          {% include 'parameter/tableau_parameter.html.twig' with { 
                              'parameters': generalParameters,
                              'category': 'general'
                          } %}
                      </tbody>
                  </table>
              </div>

              <div id="security-params" class="category-panel">
                  <h4>Paramètres de Sécurité</h4>
                  <table>
                      <thead>
                          <tr>
                              <th>Clé</th>
                              <th>Valeur</th>
                              <th>Date Début</th>
                              <th>Date Fin</th>
                              <th>Actions</th>
                          </tr>
                      </thead>
                      <tbody id="security-parameter-table">
                          {% include 'parameter/tableau_parameter.html.twig' with { 
                              'parameters': securityParameters,
                              'category': 'security'
                          } %}
                      </tbody>
                  </table>
              </div>

              <!-- Autres catégories similaires -->
          </div>
      </div>

      <div class="parameter-creation">
          {{
              form_start(createForm, {
                  action: path("app_parameter_create"),
                  method: "POST",
                  attr: { id: "createParameterForm", class: "flex" }
              })
          }}
          <div class="form-group">
              <label for="paramCategory">Catégorie</label>
              <select name="paramCategory" id="paramCategory" required>
                  <option value="general">Général</option>
                  <option value="security">Sécurité</option>
                  <option value="performance">Performance</option>
                  <option value="notifications">Notifications</option>
              </select>
          </div>
          {{ form_widget(createForm) }}
          <button type="submit" class="parameter_create">Créer un paramètre</button>
          {{ form_end(createForm) }}
      </div>
  </div>
</section>

{% block javascripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Gestion des onglets
        const tabs = document.querySelectorAll('.tab');
        const panels = document.querySelectorAll('.category-panel');

        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const category = this.dataset.category;

                // Désactiver tous les onglets et panneaux
                tabs.forEach(t => t.classList.remove('active'));
                panels.forEach(p => p.classList.remove('active'));

                // Activer l'onglet et le panneau courants
                this.classList.add('active');
                document.getElementById(`${category}-params`).classList.add('active');
            });
        });

        // Gestion des actions sur les paramètres
        document.addEventListener('click', function(e) {
            if (e.target.closest('.btn-edit-param')) {
                // Logique d'édition
            }
            if (e.target.closest('.btn-delete-param')) {
                // Logique de suppression
            }
        });
    });
</script>
{% endblock %}
{% endblock %}
